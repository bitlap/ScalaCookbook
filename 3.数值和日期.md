# 3. 数值和日期

本章涵盖了Scala数值类型，以及Java 8引入的日期和时间API的使用方法。


在Scala中，**Byte**、**Short**、**Int**、**Long**和**Char**类型被称为*整数类型*，因为它们由整型数字表示。整数类型以及**Double**和**Float**组成了Scala的*数值类型*。与被称为“非数值类型”的**Unit**和**Boolean**一样，这些数值类型都继承**AnyVal**特质（trait）。在[Scala页面](https://oreil.ly/C7Id7)（ *https://oreil.ly/C7Id7* ）关于统一类型的讨论中，这9种类型都被称为*预定义值类型*，并且不能为空。



预定义值类型与**AnyVal**和**Any**（以及**Nothing**）的关系如图3-1所示：

* 所有的数值类型都继承自**AnyVal**。

* Scala类继承结构中的所有其他类型都继承自**AnyRef**。

<img title="" src="./images/ch3/Figure3-1.jpg" alt="" data-align="center" width="783">

                       *图3-1：所有预定义的数值类型都继承自* ***AnyVal***



如表3-1所示，Scala的数值类型与Java中对应的基本类型有着相同的数值范围。



表3-1：Scala中数值类型的数值范围

| 类型         | 描述                | 范围                     |
| ---------- | ----------------- | ---------------------- |
| **Char**   | 16位无符号Unicode字符   | 0~65535                |
| **Byte**   | 8位有符号整数           | -128~127               |
| **Short**  | 16位有符号整数          | -32768~32767           |
| **Int**    | 32位有符号整数          | -2147483648~2147483647 |
| **Long**   | 64位有符号整数          | -2^63~2^63-1           |
| **Float**  | 32位IEEE 754单精度浮点数 | 见下文                    |
| **Double** | 64位IEEE 754双精度浮点数 | 见下文                    |

除此之外，**Boolean**可以为**true**或者**false**。



如果想知道数据范围的精确值，但手头没有这本书，可以在Scala REPL中查看：

```scala
 Char.MinValue.toInt // 0
 Char.MaxValue.toInt // 65535
 Byte.MinValue       // -128
 Byte.MaxValue       // +127
 Short.MinValue      // −32768
 Short.MaxValue      // +32767
 Int.MinValue        // −2147483648
 Int.MaxValue        // +2147483647
 Long.MinValue       // -9,223,372,036,854,775,808
 Long.MaxValue       // +9,223,372,036,854,775,807
 Float.MinValue      // −3.4028235e38
 Float.MaxValue      // +3.4028235e38
 Double.MinValue     // -1.7976931348623157e308
 Double.MaxValue     // +1.7976931348623157e308
```

除了这些基本数值类型之外，**BigInt**和**BigDecimal**在本章后续部分都会降到。



### 数值常量中的下划线

Scala 2.13 引入了在数值常量中使用下划线的功能：

```scala
// Int
val x = 1_000
val x = 100_000
val x = 1_000_000

// Long (也可以使用小写的‘l’, 但看起来容易跟数字’1‘混淆)
val x = 1_000_000L

// Double
val x = 1_123.45
val x = 1_123.45D
val x = 1_123.45d
val x = 1_234e2 // 123400.0

// Float
val x = 3_456.7F
val x = 3_456.7f
val x = 1_234e2F

// BigInt and BigDecimal
val x: BigInt = 1_000_000
val x: BigDecimal = 1_234.56
```



带下划线的数值常量可以使用在所有常用的地方：

```scala
val x = 1_000 + 1

if x > 1_000 && x < 1_000_000 then println(x)

x match
   case 1_000 => println("got 1,000")
   case _     => println("got something else")

for
   i <- 1 to 1_000
   if i > 999
do
   println(i)
```



目前带下划线的数值常量不能使用的一个地方是从**String**转换为数字类型：

```scala
Integer.parseInt("1_000") // NumberFormatException
"1_000".toInt             // NumberFormatException
```



### 复数

除了Scala自带的math类库，如果需要其他更强大的数学运算能力，可以了解一下[Spire](https://typelevel.org/spire)（ **https://typelevel.org/spire** ），它包含了Rational、Complex和Real等更高级的数学概念。



### 日期和时间

本章最后几节介绍了Java 8引入的日期和时间API，并展示了如何使用**LocalDate**、**LocalTime**、**LocalDateTime**、**Instant**和**ZonedDateTime**等新类。



## 3.1 从字符串到数值









- [ ]  3.2 Converting Between Numeric Types (Casting)

- [ ]  3.3 Overriding the Default Numeric Type

- [ ]  3.4 Replacements for ++ and −−

- [ ]  3.5 Comparing Floating-Point Numbers

- [ ]  3.6 Handling Large Numbers

- [ ]  3.7 Generating Random Numbers

- [ ]  3.8 Formatting Numbers and Currency

- [ ]  3.9 Creating New Date and Time Instances

- [ ]  3.10 Calculating the Difference Between Two Dates

- [ ]  3.11 Formatting Dates

- [ ]  3.12 Parsing Strings into Dates
